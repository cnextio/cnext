(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{52099:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return M}});var o=t(50029),i=t(87794),r=t.n(i),s=t(67294),a=t(79622),l=t(76240),c=t(12617),u=t(1383),h=t(2185),p=t(92777),f=t(82262),d=t(10748),v=t(45959),m=t(63553),y=t(37247),g=t(59499),k=(t(56500),t(12320)),R=t(85893);function C(n){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var t,o=(0,y.Z)(n);if(e){var i=(0,y.Z)(this).constructor;t=Reflect.construct(o,arguments,i)}else t=o.apply(this,arguments);return(0,m.Z)(this,t)}}var b=function(n){(0,v.Z)(t,n);var e=C(t);function t(n){var o;return(0,p.Z)(this,t),o=e.call(this,n),(0,g.Z)((0,d.Z)(o),"terminalRef",void 0),(0,g.Z)((0,d.Z)(o),"terminal",void 0),o.terminalRef=s.createRef(),o.onData=o.onData.bind((0,d.Z)(o)),o.onCursorMove=o.onCursorMove.bind((0,d.Z)(o)),o.onKey=o.onKey.bind((0,d.Z)(o)),o.onBinary=o.onBinary.bind((0,d.Z)(o)),o.onLineFeed=o.onLineFeed.bind((0,d.Z)(o)),o.onScroll=o.onScroll.bind((0,d.Z)(o)),o.onSelectionChange=o.onSelectionChange.bind((0,d.Z)(o)),o.onRender=o.onRender.bind((0,d.Z)(o)),o.onResize=o.onResize.bind((0,d.Z)(o)),o.onTitleChange=o.onTitleChange.bind((0,d.Z)(o)),o.setupTerminal(),o}return(0,f.Z)(t,[{key:"setupTerminal",value:function(){var n=this;this.terminal=new k.Terminal(this.props.options),this.props.addons&&this.props.addons.forEach((function(e){n.terminal.loadAddon(e)})),this.terminal.onBinary(this.onBinary),this.terminal.onCursorMove(this.onCursorMove),this.terminal.onData(this.onData),this.terminal.onKey(this.onKey),this.terminal.onLineFeed(this.onLineFeed),this.terminal.onScroll(this.onScroll),this.terminal.onSelectionChange(this.onSelectionChange),this.terminal.onRender(this.onRender),this.terminal.onResize(this.onResize),this.terminal.onTitleChange(this.onTitleChange),this.props.customKeyEventHandler&&this.terminal.attachCustomKeyEventHandler(this.props.customKeyEventHandler)}},{key:"componentDidMount",value:function(){this.terminalRef.current&&this.terminal.open(this.terminalRef.current)}},{key:"componentWillUnmount",value:function(){this.terminal.dispose()}},{key:"onBinary",value:function(n){this.props.onBinary&&this.props.onBinary(n)}},{key:"onCursorMove",value:function(){this.props.onCursorMove&&this.props.onCursorMove()}},{key:"onData",value:function(n){this.props.onData&&this.props.onData(n)}},{key:"onKey",value:function(n){this.props.onKey&&this.props.onKey(n)}},{key:"onLineFeed",value:function(){this.props.onLineFeed&&this.props.onLineFeed()}},{key:"onScroll",value:function(n){this.props.onScroll&&this.props.onScroll(n)}},{key:"onSelectionChange",value:function(){this.props.onSelectionChange&&this.props.onSelectionChange()}},{key:"onRender",value:function(n){this.props.onRender&&this.props.onRender(n)}},{key:"onResize",value:function(n){this.props.onResize&&this.props.onResize(n)}},{key:"onTitleChange",value:function(n){this.props.onTitleChange&&this.props.onTitleChange(n)}},{key:"render",value:function(){return(0,R.jsx)("div",{className:this.props.className,ref:this.terminalRef})}}]),t}(s.Component),w=t(53918);function Z(){for(var n=document.cookie.split(";"),e=0;e<n.length;e++){var t=n[e],o=t.indexOf("="),i=o>-1?t.substr(0,o):t;document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}var S,T,x=t(87974),B="Failed to fetch",F="terminalIO",M=function(){u.Z.getState();var n=(0,h.v9)((function(n){var e;return null===(e=n.projectManager.activeProject)||void 0===e?void 0:e.path})),e=(0,s.useRef)(null),t=new c.FitAddon,i=(0,h.v9)((function(n){return n.terminal.config}));function p(){return(p=(0,o.Z)(r().mark((function o(){var s,c,u,h,p,f,d;return r().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.port||!i.token){o.next=30;break}return o.prev=1,c=x.lV,null!==(s=c)&&void 0!==s&&s.endsWith("/")&&(c=c.slice(0,-1)),""===c&&(c=window.location.origin),u="".concat(c,"/jps"),h="".concat(i.token),"ws:"+u.split(":").slice(1).join(":"),p=l.ServerConnection.makeSettings({baseUrl:u,wsUrl:u.replace("http","ws"),token:h,appendToken:!0,init:{}}),a.PageConfig.setOption("terminalsAvailable","true"),f=new l.TerminalManager({serverSettings:p}),o.next=13,l.TerminalAPI.listRunning(p);case 13:if(d=o.sent,d.find((function(n){return n.name===F}))){o.next=21;break}return o.next=18,f.startNew({name:F,cwd:n});case 18:T=o.sent,o.next=22;break;case 21:T=f.connectTo({model:{name:F}});case 22:T.messageReceived.connect((function(n,t){var o;switch(t.type){case"stdout":if(t.content){var i,r=t.content[0].replaceAll("\x1b[93m","").replaceAll("\x1b[97m","");null===e||void 0===e||null===(i=e.current)||void 0===i||i.terminal.write(r)}break;case"disconnect":null===e||void 0===e||null===(o=e.current)||void 0===o||o.terminal.write("\r\n\r\n[Finished\u2026 Term Session]\r\n")}})),S=document.getElementById("Terminal"),new ResizeObserver((function(){void 0!==t&&t.fit()})).observe(S),o.next=30;break;case 27:o.prev=27,o.t0=o.catch(1),(null===o.t0||void 0===o.t0?void 0:o.t0.message)===B&&(Z(),window.location.reload());case 30:case"end":return o.stop()}}),o,null,[[1,27]])})))).apply(this,arguments)}(0,s.useEffect)((function(){return function(){p.apply(this,arguments)}(),function(){}}),[i]),(0,s.useEffect)((function(){null!==e&&void 0!==e&&e.current}),[T]);var f=(0,w.ZP)(b).withConfig({displayName:"Terminal__StyleXTerm",componentId:"sc-11fg78k-0"})(["height:100%;"]);return(0,R.jsx)(f,{onResize:function(n){var o;if(null!==e&&void 0!==e&&null!==(o=e.current)&&void 0!==o&&o.terminal&&T){var i,r;n.rows,n.cols,null===(i=S)||void 0===i||i.offsetHeight,null===(r=S)||void 0===r||r.offsetWidth;T.isDisposed||t.fit()}},options:{cursorBlink:!0,cursorStyle:"bar",cursorWidth:2,convertEol:!0,fontFamily:"monospace",fontSize:13,lineHeight:1.4,theme:{selection:"#b1b1b155",background:"white",foreground:"#808080",cursor:"#808080"}},addons:[t],onData:function(n){T&&T.send({type:"stdin",content:[n]})},ref:e})}},21763:function(){}}]);